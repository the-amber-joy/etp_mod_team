<form (ngSubmit)="openDialog(addedName)">
    <mat-form-field>
        <button type="button" matPrefix mat-icon-button (click)="addedName=''">
            <mat-icon *ngIf="addedName != ''" class="cancelX">x</mat-icon>
        </button>
        <input name="addedName" autocomplete="off" matInput [(ngModel)]="addedName" placeholder="Who is it now?">
    </mat-form-field>
    <button type="submit" color="accent" mat-raised-button [disabled]="addedName == ''">Add</button>
</form>

<div class="offenders">
    <mat-accordion>
        <mat-expansion-panel *ngFor="let offender of offenders">

            <mat-expansion-panel-header [class.changed-item]="offender.changesMade == true" class="flex-parent">
                <mat-panel-title class="flex-child">
                    <span class="name">{{offender.name}}</span>
                </mat-panel-title>
                <mat-panel-description class="flex-child">
                    <span class="status" *ngIf="!offender.isBanned" [class.warning]="offender.points == 3">{{offender.watchStatus}}</span>
                    <span class="warning status" *ngIf="offender.isBanned">Banned</span>
                </mat-panel-description>
            </mat-expansion-panel-header>
            <div class="dates">
                <div class="date-added">First Offense: {{offender.created | date}}</div>
                <div>
                    Last Updated: {{offender.updated | date}} by Admin{{Admin}}
                </div>
            </div>

            <div class="form-group points" [class.changed-item]="offender.originalPoints != offender.points">
                <mat-form-field>
                    <mat-select placeholder="Status" [(value)]="offender.points" [disabled]="offender.isBanned" [(ngModel)]="offender.points"
                        (selectionChange)="pointsChanged($event, offender)" name="points">
                        <mat-option [value]=0>Probation</mat-option>
                        <mat-option [value]=1>Watching</mat-option>
                        <mat-option [value]=2>Warned</mat-option>
                        <mat-option [value]=3>Final Straw</mat-option>
                    </mat-select>
                </mat-form-field>
            </div>

            <div class="form-group" [class.changed-item]="offender.originalStatus != offender.isBanned">
                <mat-slide-toggle color="warn" [(ngModel)]="offender.isBanned" [checked]="offender.isBanned" (change)="banStatusChanged($event, offender)"
                    name="isBanned">
                    <span *ngIf="!offender.isBanned">Banned?</span>
                    <span *ngIf="offender.isBanned">Banned on {{offender.updated | date}} by Admin{{Admin}}</span>
                </mat-slide-toggle>
            </div>

            <div class="form-group">
                <form (ngSubmit)="addNewNote(offender)">
                    <mat-form-field>
                        <button type="button" [disabled]="newNote == ''" mat-button matPrefix mat-icon-button (click)="newNote=''">
                            <mat-icon *ngIf="newNote != ''" class="cancelX">x</mat-icon>
                        </button>
                        <input matInput name="newNote" type="text" autocomplete="off" [(ngModel)]="newNote" placeholder="Add comments" />
                    </mat-form-field>
                    <button class="note-btn" type="submit" [disabled]="newNote == ''" mat-button matSuffix label="Add comment" mat-icon-button></button>
                </form>
            </div>

            <div class="form-group">
                <h3 class="mat-h3">History</h3>
                <ul *ngFor="let note of offender.notes">
                    <li [class.changed-item]="note.isNew">{{note.note}}
                        <em>({{note.created | date}} by {{note.addedBy.nickName}})</em>
                    </li>
                </ul>
            </div>

            <button class="save-btn" float="left" mat-raised-button color="primary" [disabled]="!offender.changesMade" (click)="saveChanges(offender)">Save Changes</button>
            <button class="cancel-btn" float="right" mat-raised-button color="warn" [disabled]="!offender.changesMade" (click)="discardChanges(offender)">Discard Changes</button>

        </mat-expansion-panel>
    </mat-accordion>
</div>